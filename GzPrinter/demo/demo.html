<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>RTPrinter打印demo</title>
<link rel="stylesheet" type="text/css" href="./print.css">
<script type='text/javascript' src='./jquery-1.4.2.min.js'></script>
<script type="text/javascript" src="../RTP.js"></script>
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<script type="text/javascript">
    function getPrinters() {
        getRTP().getPrinterList(function (rsp) {
            if (rsp.error) {
                alert(rsp.error);
            } else {
                var html = '';
                $.each(rsp.items, function (i, t) {
                    html += '<option value="'+t+'">'+t+'</option>';
                });
                $('#ddlPrinters').html(html);
            }
        });
    }

    function getPapers() {
        var printer = $('#ddlPrinters').val();
        if (!printer || !printer.length) {
            alert('请先选择打印机');
            return;
        }
        getRTP().getPapers(printer,function (rsp) {
            if (rsp.error) {
                alert(rsp.error);
            } else {
                var html = '';
                $.each(rsp.items, function (i, t) {
                    html += '<option value="' + i + '" data-name="'+t.PaperName+'" data-width="' + t.Width + '" data-height="' + t.Height + '">' + t.PaperName + '(宽：' + (t.Width / 100).toFixed(2)
                        + 'inc,高：' + (t.Height / 100).toFixed(2) + 'inc)' + '</option>';
                });
                $('#ddlPapers').html(html);
            }
        });
    }

    function getDpi() {
        var printer = $('#ddlPrinters').val();
        if (!printer || !printer.length) {
            alert('请先选择打印机');
            return;
        }
        getRTP().getPrinterDpi(printer, function (rsp) {
            if (rsp.error) {
                alert(rsp.error);
            } else {
                alert(JSON.stringify(rsp));
            }
        });
    }

    function check() {
        getRTP().check();
    }

    function print(preview) {
        var landscape = $('#ddlDirection').val() == "1";
        var printer = $('#ddlPrinters').val();
        var paper = $('#ddlPapers option:selected');
        var pageWidth = 210;
        var pageHeight = 297;
        var paperName = '';
        if (paper.length) {
            pageWidth = (+paper.attr('data-width')) / 100 * 25.4;
            pageHeight = (+paper.attr('data-height')) / 100 * 25.4;
            paperName = paper.attr('data-name');
        }
        getRTP({
            printer: {
                name: printer||'',
                dpi: 600,
                landscape: landscape,
                pageWidth: pageWidth,
                pageHeight: pageHeight,
                paperName: paperName
            },
            preview: preview
        }).print('.rtp-template')
    }

    function refresh(){
      window.location.reload();
    }
</script>
</head>
<body id="content-body">
<div class="rtp-template">
			<div class="rtp-header" id="headerInfo">
		         <div class="titleArea">
				 	<h1>样品信息表</h1>
				</div>
				<div class="headInfo">
			 		<span class="floatLeft">条码号：<span class="bold">201300100033</span></span>
					<span class="floatRight">记录总数：30&nbsp;</span>
			 	</div>
			 </div>
            <div class="rtp-item">
                <table class="tableTopBorder_3" id="tabContent">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>条码号</th>
                            <th>原编号</th>
                            <th>名称</th>
                            <th>样品来源</th>
                            <th>送样量(g)</th>
                            <th>类型</th>
                            <th>种类</th>
                            <th>检验类型</th>
                            <th>&nbsp;&nbsp;备注&nbsp;&nbsp;</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>BGG1000</td>
                            <td>BGG1000</td>
                            <td>
                                吉单34
                            </td>
                            <td>农业部征集</td>
                            <td>500</td>
                            <td>种子</td>
                            <td>自交系</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                                纯度&nbsp;&nbsp;
                                发芽率&nbsp;&nbsp;
                                一致性&nbsp;&nbsp;
                                水分&nbsp;&nbsp;
                                净度&nbsp;&nbsp;
                            </td>
                            <td>S1G00861</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>BGG1001</td>
                            <td>BGG1001</td>
                            <td>
                                吉单38
                            </td>
                            <td>农业部征集</td>
                            <td>1000</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00862</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>BGG1002</td>
                            <td>BGG1002</td>
                            <td>
                                吉玉106
                            </td>
                            <td>农业部征集</td>
                            <td>1001</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00863</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>BGG1003</td>
                            <td>BGG1003</td>
                            <td>
                                春育8号
                            </td>
                            <td>农业部征集</td>
                            <td>1002</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00864</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>BGG1004</td>
                            <td>BGG1004</td>
                            <td>
                                吉单88
                            </td>
                            <td>农业部征集</td>
                            <td>1003</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00865</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>BGG1005</td>
                            <td>BGG1005</td>
                            <td>
                                龙丰7号
                            </td>
                            <td>农业部征集</td>
                            <td>1004</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00866</td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>BGG1006</td>
                            <td>BGG1006</td>
                            <td>
                                远东1号
                            </td>
                            <td>农业部征集</td>
                            <td>1005</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00867</td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>BGG1007</td>
                            <td>BGG1007</td>
                            <td>
                                绿育9911
                            </td>
                            <td>农业部征集</td>
                            <td>1006</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00868</td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td>BGG1008</td>
                            <td>BGG1008</td>
                            <td>
                                九单64
                            </td>
                            <td>农业部征集</td>
                            <td>1007</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00869</td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td>BGG1009</td>
                            <td>BGG1009</td>
                            <td>
                                四育7号
                            </td>
                            <td>农业部征集</td>
                            <td>1008</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00870</td>
                        </tr>
                        <tr>
                            <td>11</td>
                            <td>BGG1010</td>
                            <td>BGG1010</td>
                            <td>
                                四育8号
                            </td>
                            <td>农业部征集</td>
                            <td>1009</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00871</td>
                        </tr>
                        <tr>
                            <td>12</td>
                            <td>BGG1011</td>
                            <td>BGG1011</td>
                            <td>
                                四育9号
                            </td>
                            <td>农业部征集</td>
                            <td>1010</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00872</td>
                        </tr>
                        <tr>
                            <td>13</td>
                            <td>BGG1012</td>
                            <td>BGG1012</td>
                            <td>
                                四育10号
                            </td>
                            <td>农业部征集</td>
                            <td>1011</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00873</td>
                        </tr>
                        <tr>
                            <td>14</td>
                            <td>BGG1013</td>
                            <td>BGG1013</td>
                            <td>
                                四育11号
                            </td>
                            <td>农业部征集</td>
                            <td>1012</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00874</td>
                        </tr>
                        <tr>
                            <td>15</td>
                            <td>BGG1014</td>
                            <td>BGG1014</td>
                            <td>
                                四育12号
                            </td>
                            <td>农业部征集</td>
                            <td>1013</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00875</td>
                        </tr>
                        <tr>
                            <td>16</td>
                            <td>BGG1015</td>
                            <td>BGG1015</td>
                            <td>
                                四育13号
                            </td>
                            <td>农业部征集</td>
                            <td>1014</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00876</td>
                        </tr>
                        <tr>
                            <td>17</td>
                            <td>BGG1016</td>
                            <td>BGG1016</td>
                            <td>
                                四育14号
                            </td>
                            <td>农业部征集</td>
                            <td>1015</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00877</td>
                        </tr>
                        <tr>
                            <td>18</td>
                            <td>BGG1017</td>
                            <td>BGG1017</td>
                            <td>
                                四育15号
                            </td>
                            <td>农业部征集</td>
                            <td>1016</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00878</td>
                        </tr>
                        <tr>
                            <td>19</td>
                            <td>BGG1018</td>
                            <td>BGG1018</td>
                            <td>
                                四育16号
                            </td>
                            <td>农业部征集</td>
                            <td>1017</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00879</td>
                        </tr>
                        <tr>
                            <td>20</td>
                            <td>BGG1019</td>
                            <td>BGG1019</td>
                            <td>
                                四育17号
                            </td>
                            <td>农业部征集</td>
                            <td>1018</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00880</td>
                        </tr>
                        <tr>
                            <td>21</td>
                            <td>BGG1020</td>
                            <td>BGG1020</td>
                            <td>
                                四育18号
                            </td>
                            <td>农业部征集</td>
                            <td>1019</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00881</td>
                        </tr>
                        <tr>
                            <td>22</td>
                            <td>BGG1021</td>
                            <td>BGG1021</td>
                            <td>
                                四育19号
                            </td>
                            <td>农业部征集</td>
                            <td>1020</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00882</td>
                        </tr>
                        <tr>
                            <td>23</td>
                            <td>BGG1022</td>
                            <td>BGG1022</td>
                            <td>
                                四育20号
                            </td>
                            <td>农业部征集</td>
                            <td>1021</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00883</td>
                        </tr>
                        <tr>
                            <td>24</td>
                            <td>BGG1023</td>
                            <td>BGG1023</td>
                            <td>
                                四育21号
                            </td>
                            <td>农业部征集</td>
                            <td>1022</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00884</td>
                        </tr>
                        <tr>
                            <td>25</td>
                            <td>BGG1024</td>
                            <td>BGG1024</td>
                            <td>
                                四育22号
                            </td>
                            <td>农业部征集</td>
                            <td>1023</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00885</td>
                        </tr>
                        <tr>
                            <td>26</td>
                            <td>BGG1025</td>
                            <td>BGG1025</td>
                            <td>
                                四育23号
                            </td>
                            <td>农业部征集</td>
                            <td>1024</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00886</td>
                        </tr>
                        <tr>
                            <td>27</td>
                            <td>BGG1026</td>
                            <td>BGG1026</td>
                            <td>
                                四育24号
                            </td>
                            <td>农业部征集</td>
                            <td>1025</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00887</td>
                        </tr>
                        <tr>
                            <td>28</td>
                            <td>BGG1027</td>
                            <td>BGG1027</td>
                            <td>
                                四育25号
                            </td>
                            <td>农业部征集</td>
                            <td>1026</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00888</td>
                        </tr>
                        <tr>
                            <td>29</td>
                            <td>BGG1028</td>
                            <td>BGG1028</td>
                            <td>
                                四育26号
                            </td>
                            <td>农业部征集</td>
                            <td>1027</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00889</td>
                        </tr>
                        <tr>
                            <td>30</td>
                            <td>BGG1029</td>
                            <td>BGG1029</td>
                            <td>
                                四育27号
                            </td>
                            <td>农业部征集</td>
                            <td>1028</td>
                            <td>果穗</td>
                            <td>杂交种</td>
                            <td width="95px">
                                真实性&nbsp;&nbsp;
                            </td>
                            <td>S1G00890</td>
                        </tr>
                    </tbody>
                </table>
            </div>
	          <div class="rtp-footer" id="footerInfo">
                  <p>谢谢惠顾，欢迎再次光临</p>
			  </div>
			 </div>
<div id="action-buttons" class="noPrint">
    <br>
    <input type="button" value="检测web打印服务是否安装" onclick="check()" />
    <input onClick="refresh()" type="button" value="刷新" class="btn">
    打印机列表：<select id="ddlPrinters"></select>
    <input onClick="getPrinters()" type="button" value="获取打印机列表" class="btn">
    纸张列表：<select id="ddlPapers"></select>
    <input onClick="getPapers()" type="button" value="获取纸张" class="btn">
    <input onClick="getDpi()" type="button" value="获取打印机分辨率" class="btn">
    纸张方向：<select id="ddlDirection">
        <option value="0">纵向</option>
        <option value="1">横向</option>
    </select>
    <input onClick="print()" type="button" value="打印" class="btn">
    <input onClick="print(1)" type="button" value="打印预览" class="btn">
    <br>
    <br>
</div>
</body>
</html>